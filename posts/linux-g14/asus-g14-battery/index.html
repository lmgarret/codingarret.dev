<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Linux battery life on an Asus G14 | CodinGarret.dev</title><meta name=keywords content><meta name=description content="A short guide to improve the battery life on Asus Zephyrus G14 running Linux.
"><meta name=author content="LM. Garret"><link rel=canonical href=https://codingarret.dev/posts/linux-g14/asus-g14-battery/><link crossorigin=anonymous href=/assets/css/stylesheet.8727c1aa07dda8f1d6401868fcbb89e468d62c75146a1ebdb086250ec564a05f.css integrity="sha256-hyfBqgfdqPHWQBho/LuJ5GjWLHUUah69sIYlDsVkoF8=" rel="preload stylesheet" as=style><link rel=icon href=https://codingarret.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://codingarret.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://codingarret.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://codingarret.dev/apple-touch-icon.png><link rel=mask-icon href=https://codingarret.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Linux battery life on an Asus G14"><meta property="og:description" content="A short guide to improve the battery life on Asus Zephyrus G14 running Linux.
"><meta property="og:type" content="article"><meta property="og:url" content="https://codingarret.dev/posts/linux-g14/asus-g14-battery/"><meta property="og:image" content="https://codingarret.dev/images/posts/asus-g14-battery/cover.jpg"><meta property="article:section" content="posts"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://codingarret.dev/images/posts/asus-g14-battery/cover.jpg"><meta name=twitter:title content="Linux battery life on an Asus G14"><meta name=twitter:description content="A short guide to improve the battery life on Asus Zephyrus G14 running Linux.
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://codingarret.dev/posts/"},{"@type":"ListItem","position":2,"name":"Linux on G14 (2020)","item":"https://codingarret.dev/posts/linux-g14/"},{"@type":"ListItem","position":3,"name":"Linux battery life on an Asus G14","item":"https://codingarret.dev/posts/linux-g14/asus-g14-battery/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Linux battery life on an Asus G14","name":"Linux battery life on an Asus G14","description":"A short guide to improve the battery life on Asus Zephyrus G14 running Linux.\n","keywords":[],"articleBody":"Context TLDR; Battery life on the G14 has always been a struggle, on Windows or Linux, but we can improve it. I’m using Aurora but this should apply to all modern Linux distros.\nHi! After letting my laptop live a long and peaceful Windows-life, I wanted to finally make the switch to Linux for this great machine. I’m already familiar with Linux, having used it for my studies, professionally, my HomeLab.. I used to go for the more familiar Ubuntu/Linux Mint/Debian distros, but this time I wanted to give Fedora a try.\nI have been reading a lot about atomic desktops, I’m quite fond of KDE on the Steam Deck, and I mainly use my laptop for development. So Aurora looked like a good fit! (spoiler: it is).\nI’m not going to detail the steps to install Aurora itself on the laptop, there are plenty of other resources covering this extensively. And this laptop is no different when it comes to dual-booting. What I wanted to cover in this post is a pain point many have encountered, initially on Windows but also once having installed Linux: battery life.\nThe G14 was marketed as a long battery life gaming laptop, which was a killer feature at the time! But there was a catch: the software quality was (is!) inferior to the hardware quality. After a few BIOS updates, the status quo seemed to be:\nbattery drain could go under ~-7w with no workload suspend would cause a much higher battery drain when resuming. Only hibernating or rebooting would allow a low battery drain Switching to Linux unfortunately comes with the same symptoms: the battery drain would remain high out of the box, also causing the fans to kick in permanently..\nI’m going to share here two ways you can reduce this energy consumption to reach reasonable levels (~-8w).\nDISCLAIMER: I’m not responsible for any damage resulting from the use of this guide and the suggested tools. USE AT YOUR OWN RISK\nTurning off the Nvidia GPU The model I have comes with a RTX 2060 Max-Q. To be honest, I don’t use it much anymore, thanks to getting Steam Deck. So personally I chose to disable it altogether, but with user-friendly tools to restore it whenever I would need it.\n(Option 1) Using supergfxctl Initially I used Bazzite on this laptop as well, before switching to Aurora. Under Bazzite, I could properly switch to integrated graphics with the pre-bundled supergfxctl, courtesy of asus-linux. Of course this assumes you picked the asus flavor when grabbing Bazzite!\nsudo supergfxctl -s integratedand logging out. This could even be handled via a KDE widget!\nUnfortunately I could not get it to work properly on Aurora. Upon logging out, SDDM (the lock screen display manager) would crash, forcing me to manually restart from the TTY with a dirty state for supergfx. Also, the supergfxd service it uses would often become unresponsive and unkillable.\nAs said before, I don’t have much use for the Nvidia dGPU anymore; so having to reboot to enable it is not a real problem in my case. Hence the second solution here that I effectively use.\n(Option 2) Using envycontrol We’ll be using envycontrol for this task. This tool supports a lot Linux distributions, including Fedora Atomic Desktop! Compared to supergfxctl, the major downside is that envycontrol will rebuild initramfs which can take a few minutes, then require a reboot to apply the new GPU mode.\nTo install it, follow envycontrol’s documentation. Once installed, run:\nsudo envycontrol -s integratedto use only the AMD integrated iGPU. In our case with the Aurora installation, it will add a layer to our image, effectively disabling the Nvidia dGPU. After a reboot, one can check that the mode is correctly set by querying:\nsudo envycontrol -q integratedThis was fairly simple, and you should already hear the silence coming out of the GPU fan! If you want to go even further and control the behavior from the task bar, you can install the optimus-gpu-switcher widget to get a nice toggle directly accessible from your task bar.\nthe optimus-gpu-switcher widget\nBut we can further improve the laptop’s battery life with this next tweak.\nEnabling the AMD PState EPP scaling driver Scary name isn’t it? We’ll try to keep it simple.\nModern AMD CPUs support a new performance scaling driver, called amd-pstate, that provides finer grain frequency management than the default ACPI driver. This driver allows the Linux kernel to directly communicate performance hints to the hardware. If you want to read more about this topic, you can read the corresponding kernel.org page.\nNow if you have asusctrl installed and especially dug into the rog-control-center UI, you would have already noticed that you can tweak in the System Performance Settings the EPP hints; that does nothing unless you activate the amd-pstate driver we have been talking about.\nEPP settings under System Performance Settings\nAnd that’s what we’re going to do!\nEnabling CPPC First, we need to enable the Collaborative Processor Performance Control (CPPC) in the BIOS. This option is unfortunately not exposed by default in Asus’ BIOS, so we will be using a BIOS Flasher, Smokeless_UMAF to enable it.\nAgain usual disclaimer, this step makes you use a powerful tool that could brick your computer. Make sure to have a method to recover your device if anything goes wrong and use at your own risk. That being said, several users on Reddit and Lemmy have been using this tool to enable the feature we want without any problem. Just make sure to read Smokeless_UMAF’s README and understand what you are doing!\nFollow Smokeless_UMAF’s documentation to boot into this BIOS Flasher. Once you are in, you will need to browse to Device manager \u003e amdcbs \u003e nbio \u003e smu \u003e cppc and go for enable.\nOnce done, reboot back into your Linux installation. The scaling driver should have already been loaded, you can check with:\ncat /sys/devices/system/cpu/cpu0/cpufreq/scaling_driver amd-pstate-eppIf you get acpi-cpufreq, that means the legacy driver is still in use. The next step may fix it, otherwise make sure you enabled the right option using Smokeless_UMAF.\nSet the AMD p-state driver’s mode Some guides say that this step is mandatory to use the driver, but I personally found that the driver was already loaded without. Nonetheless, it is better to make sure the driver’s mode is set to your liking.\nThis awesome Lemmy post details what the options are and I’ll copy the excellent documentation here:\nPassive Mode amd_pstate=passive When you set amd_pstate=passive, the processor aims for a certain performance level relative to its maximum capacity. Below a specific point, the performance is average, while above it, the performance remains at its best.\nActive Mode amd_pstate=active Setting amd_pstate=active gives low-level control to the processor’s firmware. It can prioritize either performance or energy efficiency based on software hints AND the amd_pstate_epp driver. The amd_pstate_epp (Energy Performance Preference) driver provides the firmware with a hint. On most AMD CPUs, these hints are:\ndefault performance balance_performance balance_power power Guided Mode amd_pstate=guided Choosing amd_pstate=guided lets the platform automatically select a suitable performance level within a given range based on the workload.\nI would recommend going for the amd_pstate=active mode since it would benefits from the power hints configure in the ROG control center app.\nTo change the mode, we will need to add the chosen kernel flag. In the case of Fedora Atomic desktops, this can be done by calling\nrpm-ostree kargs --editorand appending amd_pstate=active if it’s not already there. After the command completes, reboot your laptop. You can check again with\ncat /sys/devices/system/cpu/cpu0/cpufreq/scaling_driver amd-pstate-eppthat it is using the correct scaling driver.\nYou can now have a look at the energy consumption; you can use the System Monitor app, CLI tools, a KDE widget on the task bar etc.. You should notice that the energy consumption under the energy saving mode and idle load should now gravitate around smaller values (~7w in my case).\nYou can also monitor your CPU cores frequencies and check that it goes as low as 400MHz under idle load, and as high as 4000MHz (depending on the CPU):\nwatch -n.1 \"grep \\\"^[c]pu MHz\\\" /proc/cpuinfo\" And that’s it for today! Enjoy your extensive battery life on your G14. A follow-up configuration to save even more energy would be enabling hibernation, but that’s a completely different topic that would require its own guide.\nHere are some links for references on the topics that were covered in this guide:\nasus-linux/supergfxctl: https://gitlab.com/asus-linux/supergfxctl bayasdev/envycontrol: https://github.com/bayasdev/envycontrol amd-pstate CPU Performance Scaling Driver: https://www.kernel.org/doc/html//v6.7-rc2/admin-guide/pm/amd-pstate.html AMD P-State and AMD P-State EPP Scaling Driver Configuration Guide: https://lemmy.world/post/3081149 Reddit thread about enabling AMD PState on r/ZephyrusG14: https://www.reddit.com/r/ZephyrusG14/comments/16vf3z2/2020_zephyrus_g14_linux_high_temperatures_while/ ","wordCount":"1437","inLanguage":"en","image":"https://codingarret.dev/images/posts/asus-g14-battery/cover.jpg","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"LM. Garret"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://codingarret.dev/posts/linux-g14/asus-g14-battery/"},"publisher":{"@type":"Organization","name":"CodinGarret.dev","logo":{"@type":"ImageObject","url":"https://codingarret.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://codingarret.dev/ accesskey=h title="CodinGarret.dev (Alt + H)">CodinGarret.dev</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Linux battery life on an Asus G14</h1><div class=post-description>A short guide to improve the battery life on Asus Zephyrus G14 running Linux.</div><div class=post-meta>LM. Garret</div></header><figure class=entry-cover><img loading=eager src=https://codingarret.dev/images/posts/asus-g14-battery/cover.jpg alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#context aria-label=Context>Context</a></li><li><a href=#turning-off-the-nvidia-gpu aria-label="Turning off the Nvidia GPU">Turning off the Nvidia GPU</a><ul><li><a href=#option-1-using-supergfxctl aria-label="(Option 1) Using supergfxctl">(Option 1) Using supergfxctl</a></li><li><a href=#option-2-using-envycontrol aria-label="(Option 2) Using envycontrol">(Option 2) Using envycontrol</a></li></ul></li><li><a href=#enabling-the-amd-pstate-epp-scaling-driver aria-label="Enabling the AMD PState EPP scaling driver">Enabling the AMD PState EPP scaling driver</a><ul><li><a href=#enabling-cppc aria-label="Enabling CPPC">Enabling CPPC</a></li><li><a href=#set-the-amd-p-state-drivers-mode aria-label="Set the AMD p-state driver&rsquo;s mode">Set the AMD p-state driver&rsquo;s mode</a></li></ul></li></ul></div></details></div><div class=post-content><h2 id=context>Context<a hidden class=anchor aria-hidden=true href=#context>#</a></h2><blockquote><p>TLDR; Battery life on the G14 has always been a struggle, on Windows or Linux, but we can improve it. I&rsquo;m using <a href=https://getaurora.dev/>Aurora</a> but this should apply to all modern Linux distros.</p></blockquote><p>Hi! After letting my laptop live a long and peaceful Windows-life, I wanted to finally make the switch to Linux for this great machine. I&rsquo;m already familiar with Linux, having used it for my studies, professionally, my HomeLab.. I used to go for the more familiar Ubuntu/Linux Mint/Debian distros, but this time I wanted to give Fedora a try.</p><p><figure class=floatleft><a href=https://getaurora.dev/><img loading=lazy src=/images/posts/asus-g14-battery/aurora-logo.png alt="Aurora Logo" width=200px></a></figure>I have been reading a lot about atomic desktops, I&rsquo;m quite fond of KDE on the Steam Deck, and I mainly use my laptop for development. So <a href=https://getaurora.dev/>Aurora</a> looked like a good fit! (spoiler: it is).</p><p>I&rsquo;m not going to detail the steps to install Aurora itself on the laptop, there are plenty of other resources covering this extensively. And this laptop is no different when it comes to dual-booting. What I wanted to cover in this post is a pain point many have encountered, initially on Windows but also once having installed Linux: battery life.</p><p>The G14 was marketed as a long battery life gaming laptop, which was a killer feature at the time! But there was a catch: the software quality was (is!) inferior to the hardware quality. After a few BIOS updates, the status quo seemed to be:</p><ul><li>battery drain could go under ~-7w with no workload</li><li>suspend would cause a much higher battery drain when resuming. Only hibernating or rebooting would allow a low battery drain</li></ul><p>Switching to Linux unfortunately comes with the same symptoms: the battery drain would remain high out of the box, also causing the fans to kick in permanently..</p><p>I&rsquo;m going to share here two ways you can reduce this energy consumption to reach reasonable levels (~-8w).</p><blockquote><p>DISCLAIMER: I&rsquo;m not responsible for any damage resulting from the use of this guide and the suggested tools. USE AT YOUR OWN RISK</p></blockquote><h2 id=turning-off-the-nvidia-gpu>Turning off the Nvidia GPU<a hidden class=anchor aria-hidden=true href=#turning-off-the-nvidia-gpu>#</a></h2><figure class=floatright><img loading=lazy src=/images/posts/asus-g14-battery/optimus.jpg alt="Nvidia Optimus" width=200px></figure><p>The model I have comes with a RTX 2060 Max-Q. To be honest, I don&rsquo;t use it much anymore, thanks to getting Steam Deck. So personally I chose to disable it altogether, but with user-friendly tools to restore it whenever I would need it.</p><h3 id=option-1-using-supergfxctl>(Option 1) Using <code>supergfxctl</code><a hidden class=anchor aria-hidden=true href=#option-1-using-supergfxctl>#</a></h3><p>Initially I used Bazzite on this laptop as well, before switching to Aurora. Under Bazzite, I could properly switch to integrated graphics with the pre-bundled <a href=https://gitlab.com/asus-linux/supergfxctl>supergfxctl</a>, courtesy of <code>asus-linux</code>. Of course this assumes you picked the <code>asus</code> flavor when grabbing Bazzite!</p><div class=command><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo supergfxctl -s integrated</span></span></code></pre></div></div><p>and logging out. This could even be handled via a KDE widget!</p><p>Unfortunately I could not get it to work properly on Aurora. Upon logging out, SDDM (the lock screen display manager) would crash, forcing me to manually restart from the TTY with a dirty state for <code>supergfx</code>. Also, the <code>supergfxd</code> service it uses would often become unresponsive and unkillable.</p><p>As said before, I don&rsquo;t have much use for the Nvidia dGPU anymore; so having to reboot to enable it is not a real problem in my case. Hence the second solution here that I effectively use.</p><h3 id=option-2-using-envycontrol>(Option 2) Using <code>envycontrol</code><a hidden class=anchor aria-hidden=true href=#option-2-using-envycontrol>#</a></h3><p><figure class=floatleft><img loading=lazy src=/images/posts/asus-g14-battery/envy-control.png alt="envycontrol logo" width=200px></figure>We&rsquo;ll be using <a href=https://github.com/bayasdev/envycontrol>envycontrol</a> for this task. This tool supports a lot Linux distributions, including Fedora Atomic Desktop! Compared to <code>supergfxctl</code>, the major downside is that <code>envycontrol</code> will rebuild <code>initramfs</code> which <strong>can take a few minutes</strong>, then require a <strong>reboot</strong> to apply the new GPU mode.</p><p>To install it, follow <a href="https://github.com/bayasdev/envycontrol?tab=readme-ov-file#%EF%B8%8F-getting-envycontrol">envycontrol&rsquo;s documentation</a>. Once installed, run:</p><div class=command><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo envycontrol -s integrated</span></span></code></pre></div></div><p>to use only the AMD integrated iGPU. In our case with the Aurora installation, it will add a layer to our image, effectively disabling the Nvidia dGPU. After a reboot, one can check that the mode is correctly set by querying:</p><div class=command><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo envycontrol -q
</span></span><span class=line><span class=cl>integrated</span></span></code></pre></div></div><p>This was fairly simple, and you should already hear the silence coming out of the GPU fan!
If you want to go even further and control the behavior from the task bar, you can install the <a href=https://github.com/enielrodriguez/optimus-gpu-switcher>optimus-gpu-switcher</a> widget to get a nice toggle directly accessible from your task bar.</p><figure class=center><img loading=lazy src=/images/posts/asus-g14-battery/taskbar-widget.png alt="envycontrol logo" width=300px><figcaption><p>the <a href=https://github.com/enielrodriguez/optimus-gpu-switcher>optimus-gpu-switcher</a> widget</p></figcaption></figure><p>But we can further improve the laptop&rsquo;s battery life with this next tweak.</p><h2 id=enabling-the-amd-pstate-epp-scaling-driver>Enabling the AMD PState EPP scaling driver<a hidden class=anchor aria-hidden=true href=#enabling-the-amd-pstate-epp-scaling-driver>#</a></h2><p>Scary name isn&rsquo;t it? We&rsquo;ll try to keep it simple.</p><p>Modern AMD CPUs support a new performance scaling driver, called <code>amd-pstate</code>, that provides finer grain frequency management than the default ACPI driver. This driver allows the Linux kernel to directly communicate performance hints to the hardware. If you want to read more about this topic, you can read the corresponding <a href=https://www.kernel.org/doc/html//v6.7-rc2/admin-guide/pm/amd-pstate.html>kernel.org page</a>.</p><p>Now if you have <code>asusctrl</code> installed and especially dug into the <code>rog-control-center</code> UI, you would have already noticed that you can tweak in the <code>System Performance Settings</code> the EPP hints; that does nothing unless you activate the <code>amd-pstate</code> driver we have been talking about.</p><figure class=center><img loading=lazy src=/images/posts/asus-g14-battery/rog-control-epp.png alt="ROG Control Center - EPP settings"><figcaption><p>EPP settings under System Performance Settings</p></figcaption></figure><p>And that&rsquo;s what we&rsquo;re going to do!</p><h3 id=enabling-cppc>Enabling CPPC<a hidden class=anchor aria-hidden=true href=#enabling-cppc>#</a></h3><p>First, we need to enable the Collaborative Processor Performance Control (CPPC) in the BIOS. This option is unfortunately not exposed by default in Asus&rsquo; BIOS, so we will be using a BIOS Flasher, <a href=https://github.com/DavidS95/Smokeless_UMAF>Smokeless_UMAF</a> to enable it.</p><blockquote><p>Again usual disclaimer, this step makes you use a powerful tool that could brick your computer. Make sure to have a method to recover your device if anything goes wrong and use at your own risk. That being said, several users on Reddit and Lemmy have been using this tool to enable the feature we want without any problem. Just make sure to read <a href=https://github.com/DavidS95/Smokeless_UMAF>Smokeless_UMAF</a>&rsquo;s README and understand what you are doing!</p></blockquote><p>Follow Smokeless_UMAF&rsquo;s documentation to boot into this BIOS Flasher. Once you are in, you will need to browse to <code>Device manager > amdcbs > nbio > smu > cppc</code> and go for <code>enable</code>.</p><p>Once done, reboot back into your Linux installation. The scaling driver should have already been loaded, you can check with:</p><div class=command><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_driver
</span></span><span class=line><span class=cl>amd-pstate-epp</span></span></code></pre></div></div><p>If you get <code>acpi-cpufreq</code>, that means the legacy driver is still in use. The next step may fix it, otherwise make sure you enabled the right option using <code>Smokeless_UMAF</code>.</p><h3 id=set-the-amd-p-state-drivers-mode>Set the AMD p-state driver&rsquo;s mode<a hidden class=anchor aria-hidden=true href=#set-the-amd-p-state-drivers-mode>#</a></h3><p>Some guides say that this step is mandatory to use the driver, but I personally found that the driver was already loaded without. Nonetheless, it is better to make sure the driver&rsquo;s mode is set to your liking.</p><p><a href=https://lemmy.world/post/3081149>This awesome Lemmy post</a> details what the options are and I&rsquo;ll copy the excellent documentation here:</p><hr><h4 id=passive-mode-hahahugoshortcode5s5hbhb>Passive Mode
<code class="code-inline language-bash"><span style=color:#79c0ff>amd_pstate</span><span style=color:#ff7b72;font-weight:700>=</span>passive</code></h4><p>When you set
<code class="code-inline language-bash"><span style=color:#79c0ff>amd_pstate</span><span style=color:#ff7b72;font-weight:700>=</span>passive</code>, the processor aims for a certain performance level relative to its maximum capacity. Below a specific point, the performance is average, while above it, the performance remains at its best.</p><h4 id=active-mode-hahahugoshortcode5s7hbhb>Active Mode
<code class="code-inline language-bash"><span style=color:#79c0ff>amd_pstate</span><span style=color:#ff7b72;font-weight:700>=</span>active</code></h4><p>Setting
<code class="code-inline language-bash"><span style=color:#79c0ff>amd_pstate</span><span style=color:#ff7b72;font-weight:700>=</span>active</code> gives low-level control to the processor’s firmware. It can prioritize either performance or energy efficiency based on software hints AND the <code>amd_pstate_epp</code> driver. The <code>amd_pstate_epp</code> (Energy Performance Preference) driver provides the firmware with a hint. On most AMD CPUs, these hints are:</p><ul><li><code class="code-inline language-console"><span style=color:#8b949e>default</span></code></li><li><code class="code-inline language-console"><span style=color:#8b949e>performance</span></code></li><li><code class="code-inline language-console"><span style=color:#8b949e>balance_performance</span></code></li><li><code class="code-inline language-console"><span style=color:#8b949e>balance_power</span></code></li><li><code class="code-inline language-console"><span style=color:#8b949e>power</span></code></li></ul><h4 id=guided-mode-hahahugoshortcode5s14hbhb>Guided Mode
<code class="code-inline language-bash"><span style=color:#79c0ff>amd_pstate</span><span style=color:#ff7b72;font-weight:700>=</span>guided</code></h4><p>Choosing
<code class="code-inline language-bash"><span style=color:#79c0ff>amd_pstate</span><span style=color:#ff7b72;font-weight:700>=</span>guided</code> lets the platform automatically select a suitable performance level within a given range based on the workload.</p><hr><p>I would recommend going for the
<code class="code-inline language-bash"><span style=color:#79c0ff>amd_pstate</span><span style=color:#ff7b72;font-weight:700>=</span>active</code> mode since it would benefits from the power hints configure in the ROG control center app.</p><p>To change the mode, we will need to add the chosen kernel flag. In the case of Fedora Atomic desktops, this can be done by calling</p><div class=command><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rpm-ostree kargs --editor</span></span></code></pre></div></div><p>and appending
<code class="code-inline language-bash"><span style=color:#79c0ff>amd_pstate</span><span style=color:#ff7b72;font-weight:700>=</span>active</code> if it&rsquo;s not already there. After the command completes, reboot your laptop. You can check again with</p><div class=command><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_driver
</span></span><span class=line><span class=cl>amd-pstate-epp</span></span></code></pre></div></div><p>that it is using the correct scaling driver.</p><p>You can now have a look at the energy consumption; you can use the System Monitor app, CLI tools, a KDE widget on the task bar etc.. You should notice that the energy consumption under the energy saving mode and idle load should now gravitate around smaller values (~7w in my case).</p><p>You can also monitor your CPU cores frequencies and check that it goes as low as 400MHz under idle load, and as high as 4000MHz (depending on the CPU):</p><div class=command><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>watch -n.1 <span class=s2>&#34;grep \&#34;^[c]pu MHz\&#34; /proc/cpuinfo&#34;</span></span></span></code></pre></div></div><hr><p>And that&rsquo;s it for today! Enjoy your extensive battery life on your G14. A follow-up configuration to save even more energy would be enabling hibernation, but that&rsquo;s a completely different topic that would require its own guide.</p><p>Here are some links for references on the topics that were covered in this guide:</p><ul><li><em>asus-linux/supergfxctl</em>: <a href=https://gitlab.com/asus-linux/supergfxctl>https://gitlab.com/asus-linux/supergfxctl</a></li><li><em>bayasdev/envycontrol</em>: <a href=https://github.com/bayasdev/envycontrol>https://github.com/bayasdev/envycontrol</a></li><li><em>amd-pstate CPU Performance Scaling Driver</em>: <a href=https://www.kernel.org/doc/html//v6.7-rc2/admin-guide/pm/amd-pstate.html>https://www.kernel.org/doc/html//v6.7-rc2/admin-guide/pm/amd-pstate.html</a></li><li><em>AMD P-State and AMD P-State EPP Scaling Driver Configuration Guide</em>: <a href=https://lemmy.world/post/3081149>https://lemmy.world/post/3081149</a></li><li><em>Reddit thread about enabling AMD PState on r/ZephyrusG14</em>: <a href=https://www.reddit.com/r/ZephyrusG14/comments/16vf3z2/2020_zephyrus_g14_linux_high_temperatures_while/>https://www.reddit.com/r/ZephyrusG14/comments/16vf3z2/2020_zephyrus_g14_linux_high_temperatures_while/</a></li></ul></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://codingarret.dev/>CodinGarret.dev</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll(".command > .highlight > pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.firstChild.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script defer src=https://umami.lmgarret.fr/script.js data-website-id=4bb24348-dc61-47eb-98b1-ca1589ec1078></script></body></html>